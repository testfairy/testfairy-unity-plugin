language: php
sudo: false
before_install:
  - brew install ant
  - wget -O /usr/local/android-sdk_r23.0.2-macosx.zip https://dl.google.com/android/android-sdk_r23.0.2-macosx.zip
  - unzip -d /usr/local /usr/local/android-sdk_r23.0.2-macosx.zip
  - export ANDROID_HOME=/usr/local/android-sdk-macosx
  - export PATH=$PATH:$ANDROID_HOME/tools
  - ( sleep 1 && while [ 1 ]; do sleep 1; echo y; done ) | android update sdk --all --no-ui --filter platform-tool,android-23,sysimg-23,build-tools-23.0.3,extra-android-support,sys-img-armeabi-v7a-android-19

before_script:
  - android update project -t android-23 -p android/.

script:
  - ant -f ./Plugins/Android/bridge/build.xml jar
  - zip -rp9 "TestFairySDK-${TRAVIS_TAG}-Unity.zip" Plugins -x Plugins/Android/bridge\*

deploy:
  provider: releases
  api_key:
    secure: DeCE3UiQBTxbuSskkBjMXkdXKvxiiJoPfvNVR874wNB0BEoAm+ZYMN+9XPuIlKfl0Fpd7XktaAvXEn2xK1FO7OXcJYPP1GZbyLwkzBm/YNmi4dHWr9BvPJzqdhLIEGw56pxuc2I6DOVys63rIZE9g1Ob68sm6ampNNfQfaXwk1s=
  file: TestFairySDK-${TRAVIS_TAG}-Unity.zip
  skip_cleanup: true
  on:
    tags: true

